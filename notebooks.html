
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Predicción del Precio de Viviendas en California mediante Modelos de Aprendizaje Automático &#8212; Introducción a House Price Prediction in California</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Introducción análsis predictivo de dataset “California Housing Prices.csv” usando modelos de aprendizaje supervisado (Supervised Learning)" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Introducción a House Price Prediction in California - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Introducción a House Price Prediction in California - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introducción análsis predictivo de dataset “California Housing Prices.csv” usando modelos de aprendizaje supervisado (Supervised Learning)
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><font color="#30143">Predicción del Precio de Viviendas en California mediante Modelos de Aprendizaje Automático </font></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/notebooks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><font color="#30143">Predicción del Precio de Viviendas en California mediante Modelos de Aprendizaje Automático </font></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">1. <font color="#30143">Introducción</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importar-liberias">1.1 <font color="#30143">Importar Liberías</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cargar-el-dataset">1.2 <font color="#30143">Cargar el dataset</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-descriptivo">2. <font color="#30143">Análisis Descriptivo</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimension-del-conjunto-de-datos">2.1 <font color="#30143">Dimensión del Conjunto de datos</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#representacion-del-conjunto-de-datos">2.2 <font color="#30143">Representación del Conjunto de datos</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-estadistico">2.3 <font color="#30143">Resumen Estadístico</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tipo-de-dato">2.4 <font color="#30143">Tipo de dato</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-de-atributos">2.4 <font color="#30143">Correlación de Atributos</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#valores-nan">2.5 <font color="#30143">Valores NaN</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-del-conjunto-de-datos">3. <font color="#30143">Visualización del Conjunto de datos</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma-y-grafico-de-densidad">3.1 <font color="#30143"> Histograma y gráfico de densidad</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagrama-de-cajas-y-bigotes">3.2 <font color="#30143"> Diagrama de Cajas y Bigotes</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagramas-de-dispersion">3.3 <font color="#30143"> Diagramas de dispersión</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion">3.4 <font color="#30143"> Matriz de Correlación</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-de-modelos">4. <font color="#30143">Construcción de Modelos</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-k-nearest-neighbors-knn">4.1 <font color="#30143">Construcción del modelo K-Nearest Neighbors (KNN)</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-linear-regression-lr">4.2 <font color="#30143">Construcción del modelo Linear Regression (LR)</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-support-vector-machines-svm">4.3 <font color="#30143">Construcción del modelo Support Vector Machines (SVM)</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-svm-usando-kernel-linear">4.3.1 <font color="#30143">Construcción del modelo SVM usando Kernel Linear</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-svm-usando-kernel-polinomial">4.3.2 <font color="#30143">Construcción del modelo SVM usando Kernel Polinomial</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-svm-usando-kernel-rbf-radial-basis-function">4.3.3 <font color="#30143">Construcción del modelo SVM usando Kernel RBF (Radial Basis Function)</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-lasso">4.4 <font color="#30143">Construcción del modelo Lasso</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-ridge">4.5 <font color="#30143">Construcción del modelo Ridge</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-de-rendimiento-de-modelos">5. <font color="#30143">Comparación de rendimiento de modelos</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">6. <font color="#30143">Conclusiones</font></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="prediccion-del-precio-de-viviendas-en-california-mediante-modelos-de-aprendizaje-automatico">
<h1><font color="#30143">Predicción del Precio de Viviendas en California mediante Modelos de Aprendizaje Automático </font><a class="headerlink" href="#prediccion-del-precio-de-viviendas-en-california-mediante-modelos-de-aprendizaje-automatico" title="Link to this heading">#</a></h1>
<p><br><br></p>
<hr class="docutils" />
<section id="introduccion">
<h2>1. <font color="#30143">Introducción</font><a class="headerlink" href="#introduccion" title="Link to this heading">#</a></h2>
<p>En esta investigación, utilizaremos el conjunto de datos <em>California Housing Prices.csv</em>, que consta de 20.640 instancias. Cada instancia representa una unidad residencial en el estado de California y contiene 10 atributos, incluyendo la variable objetivo. Los atributos se definen de la siguiente manera:</p>
<ul class="simple">
<li><p>longitude : Medida de qué tan al oeste está una unidad residencial; un valor más alto es más al oeste.</p></li>
<li><p>latitude : Medida de qué tan al norte está una unidad residencial; un valor más alto es más al norte.</p></li>
<li><p>housingMedianAge : Edad media de una casa dentro de una unidad residencial; un número más bajo es un edificio más nuevo</p></li>
<li><p>totalRooms : Número total de habitaciones dentro de unidad residencial</p></li>
<li><p>totalBedrooms : Número total de dormitorios dentro de unidad residencial</p></li>
<li><p>population : Número total de personas que residen dentro de unidad residencial</p></li>
<li><p>households : Número total de viviendas en unidad residencial.</p></li>
<li><p>medianIncome : Ingreso medio de los hogares dentro de una unidad residencial (medido en decenas de miles de dólares estadounidenses)</p></li>
<li><p>medianHouseValue : Valor medio de la casa para los hogares dentro de una unidad residencial (medido en dólares estadounidenses)</p></li>
<li><p>oceanProximity : Ubicación de la una unidad residencial con respecto al océano/mar</p></li>
</ul>
<div class="alert alert-block" style="background-color: #e1d9e3; color: #30143; padding: 10px; border-radius: 10px;">
    <i class="fa fa-info-circle" aria-hidden="true"></i>
    <strong>Importante:</strong>
Cada observación corresponde a una unidad resindecial, conjunto o bloques de viviendas.
</div><section id="importar-liberias">
<h3>1.1 <font color="#30143">Importar Liberías</font><a class="headerlink" href="#importar-liberias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Classification Project: Sonar rocks or mines</span>

<span class="c1"># Load libraries</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="c1"># Load sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">ElasticNet</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">,</span> <span class="n">Lasso</span>



<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cargar-el-dataset">
<h3>1.2 <font color="#30143">Cargar el dataset</font><a class="headerlink" href="#cargar-el-dataset" title="Link to this heading">#</a></h3>
<p>El conjunto de datos de <em>Boston Housing Price.</em> Puede ver que estamos especificando los nombres cortos para cada atributo para que podamos referenciarlos claramente más adelante. También puede ver que los atributos están delimitados por espacios en blanco en lugar de comas en este archivo e indicamos esto a la función <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> a través del argumento <code class="docutils literal notranslate"><span class="pre">delim.whitespace</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar bibliotecas necesarias</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/kathy/Desktop/ml/Autoestudio/Udemy/data/housingcaliforia.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1">#df = pd.read_csv(&#39;housingcaliforia.csv&#39;)#Lectura de datos</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># Mostrar las primeras filas del conjunto de datos</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
      <th>ocean_proximity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-122.23</td>
      <td>37.88</td>
      <td>41.0</td>
      <td>880.0</td>
      <td>129.0</td>
      <td>322.0</td>
      <td>126.0</td>
      <td>8.3252</td>
      <td>452600.0</td>
      <td>NEAR BAY</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-122.22</td>
      <td>37.86</td>
      <td>21.0</td>
      <td>7099.0</td>
      <td>1106.0</td>
      <td>2401.0</td>
      <td>1138.0</td>
      <td>8.3014</td>
      <td>358500.0</td>
      <td>NEAR BAY</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-122.24</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>1467.0</td>
      <td>190.0</td>
      <td>496.0</td>
      <td>177.0</td>
      <td>7.2574</td>
      <td>352100.0</td>
      <td>NEAR BAY</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-122.25</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>1274.0</td>
      <td>235.0</td>
      <td>558.0</td>
      <td>219.0</td>
      <td>5.6431</td>
      <td>341300.0</td>
      <td>NEAR BAY</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-122.25</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>1627.0</td>
      <td>280.0</td>
      <td>565.0</td>
      <td>259.0</td>
      <td>3.8462</td>
      <td>342200.0</td>
      <td>NEAR BAY</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div style="text-align: right"> <font size=5>
    <a href="#indice"><i class="fa fa-arrow-circle-up" aria-hidden="true" style="color:#004D7F"></i></a>
</font></div>
</section>
</section>
<hr class="docutils" />
<section id="analisis-descriptivo">
<h2>2. <font color="#30143">Análisis Descriptivo</font><a class="headerlink" href="#analisis-descriptivo" title="Link to this heading">#</a></h2>
<p>Ahora es el momento de estudiar nuestros datos.</p>
<section id="dimension-del-conjunto-de-datos">
<h3>2.1 <font color="#30143">Dimensión del Conjunto de datos</font><a class="headerlink" href="#dimension-del-conjunto-de-datos" title="Link to this heading">#</a></h3>
<p>Podemos tener una idea rápida de cuántas instancias (filas) y cuántos atributos (columnas) hay en nuestro conjunto de datos con la propiedad <code class="docutils literal notranslate"><span class="pre">shape</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># shape</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(20640, 10)
</pre></div>
</div>
</div>
</div>
<p>Puede verse 20.640 instancias y 10 atributos (incluyendo la clase <code class="docutils literal notranslate"><span class="pre">median_house_value</span></code>).</p>
</section>
<section id="representacion-del-conjunto-de-datos">
<h3>2.2 <font color="#30143">Representación del Conjunto de datos</font><a class="headerlink" href="#representacion-del-conjunto-de-datos" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># head</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
      <th>ocean_proximity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-122.23</td>
      <td>37.88</td>
      <td>41.0</td>
      <td>880.0</td>
      <td>129.0</td>
      <td>322.0</td>
      <td>126.0</td>
      <td>8.3252</td>
      <td>452600.0</td>
      <td>NEAR BAY</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-122.22</td>
      <td>37.86</td>
      <td>21.0</td>
      <td>7099.0</td>
      <td>1106.0</td>
      <td>2401.0</td>
      <td>1138.0</td>
      <td>8.3014</td>
      <td>358500.0</td>
      <td>NEAR BAY</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-122.24</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>1467.0</td>
      <td>190.0</td>
      <td>496.0</td>
      <td>177.0</td>
      <td>7.2574</td>
      <td>352100.0</td>
      <td>NEAR BAY</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-122.25</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>1274.0</td>
      <td>235.0</td>
      <td>558.0</td>
      <td>219.0</td>
      <td>5.6431</td>
      <td>341300.0</td>
      <td>NEAR BAY</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-122.25</td>
      <td>37.85</td>
      <td>52.0</td>
      <td>1627.0</td>
      <td>280.0</td>
      <td>565.0</td>
      <td>259.0</td>
      <td>3.8462</td>
      <td>342200.0</td>
      <td>NEAR BAY</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Podemos ver que las escalas de los atributos están por todas partes debido a las diferentes unidades. Podemos beneficiarnos de algunas transformaciones más adelante, excluyendo los atributos de <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code>, y <code class="docutils literal notranslate"><span class="pre">median_house_value</span></code></p>
</section>
<section id="resumen-estadistico">
<h3>2.3 <font color="#30143">Resumen Estadístico</font><a class="headerlink" href="#resumen-estadistico" title="Link to this heading">#</a></h3>
<p>A continuación, se presenta un resumen de las métricas de estadística descriptiva, que incluye indicadores clave como la media, la desviación estándar, así como los valores mínimos y máximos, entre otros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># descriptions</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20640.00</td>
      <td>20640.00</td>
      <td>20640.00</td>
      <td>20640.00</td>
      <td>20433.00</td>
      <td>20640.00</td>
      <td>20640.00</td>
      <td>20640.00</td>
      <td>20640.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-119.57</td>
      <td>35.63</td>
      <td>28.64</td>
      <td>2635.76</td>
      <td>537.87</td>
      <td>1425.48</td>
      <td>499.54</td>
      <td>3.87</td>
      <td>206855.82</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.00</td>
      <td>2.14</td>
      <td>12.59</td>
      <td>2181.62</td>
      <td>421.39</td>
      <td>1132.46</td>
      <td>382.33</td>
      <td>1.90</td>
      <td>115395.62</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-124.35</td>
      <td>32.54</td>
      <td>1.00</td>
      <td>2.00</td>
      <td>1.00</td>
      <td>3.00</td>
      <td>1.00</td>
      <td>0.50</td>
      <td>14999.00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-121.80</td>
      <td>33.93</td>
      <td>18.00</td>
      <td>1447.75</td>
      <td>296.00</td>
      <td>787.00</td>
      <td>280.00</td>
      <td>2.56</td>
      <td>119600.00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-118.49</td>
      <td>34.26</td>
      <td>29.00</td>
      <td>2127.00</td>
      <td>435.00</td>
      <td>1166.00</td>
      <td>409.00</td>
      <td>3.53</td>
      <td>179700.00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>-118.01</td>
      <td>37.71</td>
      <td>37.00</td>
      <td>3148.00</td>
      <td>647.00</td>
      <td>1725.00</td>
      <td>605.00</td>
      <td>4.74</td>
      <td>264725.00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>-114.31</td>
      <td>41.95</td>
      <td>52.00</td>
      <td>39320.00</td>
      <td>6445.00</td>
      <td>35682.00</td>
      <td>6082.00</td>
      <td>15.00</td>
      <td>500001.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>longitude: para esta variable tenemos un total de 20,640 observaciones, con una media de -119.57 y desviación estándar de 2, mostrando que las unidades residenciales están ubicadas relativamente cercanas la una de las otras en términos de longitud. Por otro lado, observamos que la longitud mínima es de -124.35 y la máxima de -114.31, coherente con lo planteado en cuento a la cercanía de las unidades residenciales. También podemos indicar que la mitad de las unidades se encuentran ubicadas en una longitud entre el -124.35 y -118.49; dándonos indicios de que lo datos no siguen una distribución normal debido a las diferencias entre la media y la mediana.</p></li>
<li><p>latitude: para esta variable tenemos un total de 20,640 observaciones, con una media de 35.63 y desviación estándar de 2.14, mostrando que las unidades residenciales están ubicadas relativamente cercanas la una de las otras en términos de latitud (que en contraste con la variable anterior, se puede decir que las unidades residenciales están concentradas en una misma zona geográfica). Por otro lado, observamos que la latitud mínima es de 32.54  y la máxima de 41.95, coherente con lo planteado en cuento a la cercanía de las unidades residenciales. También podemos indicar que la mitad de las unidades se encuentran ubicadas en una longitud entre el 32.54 y 34.26.</p></li>
<li><p>housingMedianAge: la media del promedio de la edad de las casa de los conjunto de viviendas es de 28.64 años; con una desviación estándar de 12.59, lo que nos muestra una distribución bastante amplia; indicando que aprox el 68.2% de la edad media de los conjuntos de viviendas se encuentra entre 16.05 y 41.23; además de un rango de años entre 1 y 52.</p></li>
<li><p>totalRooms: tenemos que el numero promedio de habitaciones de las unidades residenciales es de 2,635.37, con desviación estándar de 2,181.62; evidenciando una distribución muy amplia, que se refuerza al comprobar que el mínimo dentro de esta variable es de 2 y el máximo de 39,320.00. A partir de esto también se obtiene indicios de un sesgo a la izquierda de la distribución; dada la gran diferencia entre la media y el número máximo de habitaciones por unidad residencial.</p></li>
<li><p>totalBedrooms: por el lado del total de dormitorios la distribución presenta un comportamiento similar al de la variable anterior, probablemente porque esta correlacionadas. Con una media 537.87 y desviación estándar de 421.39.  A partir de esto también se obtiene indicios de un sesgo a la izquierda de la distribución; dada la gran diferencia entre la media y el número máximo de dormitorios por unidad residencial. Esta es la única variable que cuenta con missing values.</p></li>
<li><p>population: en cuanto a la población de las unidades residenciales, en promedio estas cuentan con 1,425 habitantes; con una desviación estándar de 1,132. Lo anterior también en relación con las dos variables precedentes, con un rango amplio entre 3 y 35,682 habitantes. A partir de esto también se obtiene indicios de un sesgo a la izquierda de la distribución; dada la gran diferencia entre la media y el número máximo de habitantes por unidad residencial.</p></li>
<li><p>households: en relación con las tres variables anteriores se observa un comportamiento similar; que posteriormente se observará en un análisis de correlación. Vemos que em promedio, las unidades residenciales tienen 500 viviendas, con una desviación de 382, indicando una amplitud considerable en la distribución. Con un mínimos de 1 vivienda y máximo de 6,082.</p></li>
<li><p>medianIncome: en cuanto a los ingresos medios de los hogares con un promedio de 38,700 dólares y una desviación estándar de 19,000. Además observamos un mínimo de 5,000  y máximo de 1500,000; dando un rango de distribución bastante amplio; así como un sesgo a la izquierda de la misma.</p></li>
<li><p>medianHouseValue: nuestro target muestra una media de 206,855.82 y desviación estándar de 115,395.62 dólares; mínimo y máximo de 14,999.00 y 500,001.00 respectivamente. Con una distribución amplia, con un sesgo moderado a la izquierda.</p></li>
</ul>
</section>
<section id="tipo-de-dato">
<h3>2.4 <font color="#30143">Tipo de dato</font><a class="headerlink" href="#tipo-de-dato" title="Link to this heading">#</a></h3>
<p>Podemos ver el tipo de variable de cada atributo con la propiedad <code class="docutils literal notranslate"><span class="pre">dtypes</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># types</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>longitude             float64
latitude              float64
housing_median_age    float64
total_rooms           float64
total_bedrooms        float64
population            float64
households            float64
median_income         float64
median_house_value    float64
ocean_proximity        object
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Podemos ver que todos los atributos en su mayoría son numéricos, en su mayoría valores reales <em>(float64)</em> y el atrítubo que define la próximidad al oceano es categórico y tiene 4 niveles y/o etiquetas, las cuales, se pueden observar a continuación:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ocean_proximity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;NEAR BAY&#39;, &#39;&lt;1H OCEAN&#39;, &#39;INLAND&#39;, &#39;NEAR OCEAN&#39;, &#39;ISLAND&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="correlacion-de-atributos">
<h3>2.4 <font color="#30143">Correlación de Atributos</font><a class="headerlink" href="#correlacion-de-atributos" title="Link to this heading">#</a></h3>
<p>Es importante garantizar la ausencia de relación entre atríbutos, por tal razón lo utilizaremos la función <code class="docutils literal notranslate"><span class="pre">corr(method='pearson')</span></code> para verificar que se cumpla esta condición.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cor</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">])</span>
<span class="c1"># correlation</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">df_cor</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>longitude</th>
      <td>1.0000</td>
      <td>-0.9247</td>
      <td>-0.1082</td>
      <td>0.0446</td>
      <td>0.0696</td>
      <td>0.0998</td>
      <td>0.0553</td>
      <td>-0.0152</td>
      <td>-0.0460</td>
    </tr>
    <tr>
      <th>latitude</th>
      <td>-0.9247</td>
      <td>1.0000</td>
      <td>0.0112</td>
      <td>-0.0361</td>
      <td>-0.0670</td>
      <td>-0.1088</td>
      <td>-0.0710</td>
      <td>-0.0798</td>
      <td>-0.1442</td>
    </tr>
    <tr>
      <th>housing_median_age</th>
      <td>-0.1082</td>
      <td>0.0112</td>
      <td>1.0000</td>
      <td>-0.3613</td>
      <td>-0.3205</td>
      <td>-0.2962</td>
      <td>-0.3029</td>
      <td>-0.1190</td>
      <td>0.1056</td>
    </tr>
    <tr>
      <th>total_rooms</th>
      <td>0.0446</td>
      <td>-0.0361</td>
      <td>-0.3613</td>
      <td>1.0000</td>
      <td>0.9304</td>
      <td>0.8571</td>
      <td>0.9185</td>
      <td>0.1980</td>
      <td>0.1342</td>
    </tr>
    <tr>
      <th>total_bedrooms</th>
      <td>0.0696</td>
      <td>-0.0670</td>
      <td>-0.3205</td>
      <td>0.9304</td>
      <td>1.0000</td>
      <td>0.8777</td>
      <td>0.9797</td>
      <td>-0.0077</td>
      <td>0.0497</td>
    </tr>
    <tr>
      <th>population</th>
      <td>0.0998</td>
      <td>-0.1088</td>
      <td>-0.2962</td>
      <td>0.8571</td>
      <td>0.8777</td>
      <td>1.0000</td>
      <td>0.9072</td>
      <td>0.0048</td>
      <td>-0.0246</td>
    </tr>
    <tr>
      <th>households</th>
      <td>0.0553</td>
      <td>-0.0710</td>
      <td>-0.3029</td>
      <td>0.9185</td>
      <td>0.9797</td>
      <td>0.9072</td>
      <td>1.0000</td>
      <td>0.0130</td>
      <td>0.0658</td>
    </tr>
    <tr>
      <th>median_income</th>
      <td>-0.0152</td>
      <td>-0.0798</td>
      <td>-0.1190</td>
      <td>0.1980</td>
      <td>-0.0077</td>
      <td>0.0048</td>
      <td>0.0130</td>
      <td>1.0000</td>
      <td>0.6881</td>
    </tr>
    <tr>
      <th>median_house_value</th>
      <td>-0.0460</td>
      <td>-0.1442</td>
      <td>0.1056</td>
      <td>0.1342</td>
      <td>0.0497</td>
      <td>-0.0246</td>
      <td>0.0658</td>
      <td>0.6881</td>
      <td>1.0000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Podemos ver que muchos de los atributos tienen una fuerte correlación (por ejemplo, <span class="math notranslate nohighlight">\(&gt;0.75\)</span> o <span class="math notranslate nohighlight">\(&lt;−0.75\)</span>). Por ejemplo:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total_rooms</span></code> y <code class="docutils literal notranslate"><span class="pre">total_bedrooms</span></code> con 0.93.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_rooms</span></code> y <code class="docutils literal notranslate"><span class="pre">population</span></code> con 0.86.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_bedrooms</span></code> y <code class="docutils literal notranslate"><span class="pre">population</span></code> con 0.88.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_rooms</span></code> y <code class="docutils literal notranslate"><span class="pre">households</span></code> con 0.91.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_bedrooms</span></code> y <code class="docutils literal notranslate"><span class="pre">households</span></code> con 0.98.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">population</span></code> y <code class="docutils literal notranslate"><span class="pre">households</span></code> con 0.91.</p></li>
</ul>
</section>
<section id="valores-nan">
<h3>2.5 <font color="#30143">Valores NaN</font><a class="headerlink" href="#valores-nan" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">total_rows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">missing_vars</span> <span class="o">=</span> <span class="n">missing_values</span><span class="p">[</span><span class="n">missing_values</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">missing_info_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Datos faltantes&#39;</span><span class="p">:</span> <span class="n">missing_vars</span><span class="p">,</span>
    <span class="s1">&#39;Porcentaje (%)&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">((</span><span class="n">missing_vars</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)})</span>

<span class="n">missing_info_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Datos faltantes</th>
      <th>Porcentaje (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>total_bedrooms</th>
      <td>207</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Podemos observar que existen datos faltantes para nuestro atríbuto total_bedromms. Procedemos a realizar imputación a reemplazando los valores NaN por la media.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;total_bedrooms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;total_bedrooms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;total_bedrooms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Verificamos nuevamente la existencia de datos faltantes a tráves de la función <code class="docutils literal notranslate"><span class="pre">info()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 10 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   longitude           20640 non-null  float64
 1   latitude            20640 non-null  float64
 2   housing_median_age  20640 non-null  float64
 3   total_rooms         20640 non-null  float64
 4   total_bedrooms      20640 non-null  float64
 5   population          20640 non-null  float64
 6   households          20640 non-null  float64
 7   median_income       20640 non-null  float64
 8   median_house_value  20640 non-null  float64
 9   ocean_proximity     20640 non-null  object 
dtypes: float64(9), object(1)
memory usage: 1.6+ MB
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="visualizacion-del-conjunto-de-datos">
<h2>3. <font color="#30143">Visualización del Conjunto de datos</font><a class="headerlink" href="#visualizacion-del-conjunto-de-datos" title="Link to this heading">#</a></h2>
<p>A continuación se visualiza las gráficas de cada variable de forma individual.</p>
<section id="histograma-y-grafico-de-densidad">
<h3>3.1 <font color="#30143"> Histograma y gráfico de densidad</font><a class="headerlink" href="#histograma-y-grafico-de-densidad" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Univariate Histograms</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;housing_median_age&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#30143F&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;total_rooms&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#30143F&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;total_bedrooms&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#30143F&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;population&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#30143F&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;households&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#30143F&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;median_income&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#30143F&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;median_house_value&quot;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#30143F&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;median_house_value&#39;, ylabel=&#39;Density&#39;&gt;
</pre></div>
</div>
<img alt="_images/39c47a3f260d673f17b7b124c1916da0fba097f8d604b6a3b4629c774c9ac0d3.png" src="_images/39c47a3f260d673f17b7b124c1916da0fba097f8d604b6a3b4629c774c9ac0d3.png" />
</div>
</div>
</section>
<section id="diagrama-de-cajas-y-bigotes">
<h3>3.2 <font color="#30143"> Diagrama de Cajas y Bigotes</font><a class="headerlink" href="#diagrama-de-cajas-y-bigotes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Configura la figura general y el tamaño de los subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="c1"># Subplot para housing_median_age</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">441</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;housing_median_age&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c6b1c9&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Antiguedad de la Vivienda&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Subplot para total_rooms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">442</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;total_rooms&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c6b1c9&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Número total de habitaciones&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Subplot para total_bedrooms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">443</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;total_bedrooms&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c6b1c9&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Número de dormitorios&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Subplot para population</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">444</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;population&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c6b1c9&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Número total de residentes por manzana&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Subplot para households</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">445</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;households&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c6b1c9&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Número de residentes de una vivienda por manzana&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Subplot para median_income</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">446</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;median_income&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c6b1c9&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ingreso medio por vivienda por manzana&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>



<span class="c1"># Subplot para median_house_value</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">447</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;median_house_value&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c6b1c9&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Precio de Vivienda promedio por manzana&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Mostrar los gráficos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c48711cef8765d7a7b50b0ae5462cc70c39c7f54643f5c67b74266c305ca04ab.png" src="_images/c48711cef8765d7a7b50b0ae5462cc70c39c7f54643f5c67b74266c305ca04ab.png" />
</div>
</div>
<p>A través del diagrama de cajas y bigotes, además de evidenciar gráficamente lo mostrado en el resumen estadístico, como el sesgo, la simetría de la distribución y las medidas de posición; podemos observar el comportamiento que presentan las variables en cuanto los outliers. En ese sentido, observamos que a excepción de la edad de las casas, los atributos susceptibles a este análisis presentan datos atípicos y de estos últimos; a excepción del valor medio de las viviendas; presentan un número considerable de outliers.</p>
</section>
<section id="diagramas-de-dispersion">
<h3>3.3 <font color="#30143"> Diagramas de dispersión</font><a class="headerlink" href="#diagramas-de-dispersion" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df_cor</span><span class="p">,</span>
             <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#30143F&#39;</span><span class="p">},</span>   <span class="c1"># Color de los scatter plots</span>
             <span class="n">diag_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#30143F&#39;</span><span class="p">})</span>   <span class="c1"># Color de los histogramas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x18b7a8e8040&gt;
</pre></div>
</div>
<img alt="_images/68e7bcf5af34e240bb0b53504c3eaa22cf9d79ddd7698c2333216af176ba8682.png" src="_images/68e7bcf5af34e240bb0b53504c3eaa22cf9d79ddd7698c2333216af176ba8682.png" />
</div>
</div>
</section>
<section id="matriz-de-correlacion">
<h3>3.4 <font color="#30143"> Matriz de Correlación</font><a class="headerlink" href="#matriz-de-correlacion" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">df_cor</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df_cor</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">),</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">square</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Correlación&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9055a2dfe24c34db981cf7335fed0c6091b97614e8e83b53440d94cef8ceac1e.png" src="_images/9055a2dfe24c34db981cf7335fed0c6091b97614e8e83b53440d94cef8ceac1e.png" />
</div>
</div>
<p>la matriz de correlación nos muestra el grado de asación entre las variables en cuestión, por pares.</p>
<p>Observamos una alta correlación negativa o inversa entre la latitud y la longitud, sin embargo; por la naturaleza de estas variables no se asocia dicha correlación a un comportamiento de dependencia entre estas.</p>
<p>En cuanto al total de habitaciones, observamos que presenta correlación directa con el total de dormitorios; guardando correspondencia con el sentido común atendiendo a que en la mayoría de casas; la mitad o más de sus espacios corresponden a dormitorios y por supuesto; a mayor número de habitaciones mayor número de dormitorios. Asimismo, existe correlación directa con la población, guardando coherencia también con la lógica de que entre más habitantes tenga un bloque de residencias, más dormitorios tendrá. Por último, con el número de viviendas, que entre más viviendas tenga la unidad; mayor número de habitaciones s contará en esta.</p>
<p>El total de dormitorios por su puesto guarda correlación directa con el número de habitantes; en el sentido de la lógica expresada anteriormente. De igual modo con el número total de viviendas por unidad. Por otro lado, observamos correlación entre el ingreso medio de las viviendas de las unidades residenciales y el valor de las viviendas.</p>
</section>
</section>
<hr class="docutils" />
<section id="construccion-de-modelos">
<h2>4. <font color="#30143">Construcción de Modelos</font><a class="headerlink" href="#construccion-de-modelos" title="Link to this heading">#</a></h2>
<section id="construccion-del-modelo-k-nearest-neighbors-knn">
<h3>4.1 <font color="#30143">Construcción del modelo K-Nearest Neighbors (KNN)</font><a class="headerlink" href="#construccion-del-modelo-k-nearest-neighbors-knn" title="Link to this heading">#</a></h3>
<p>Dividiremos el conjunto de datos cargado en dos, el 70% de los cuales utilizaremos para entrenar nuestros modelos y el 30% como un conjunto de datos de validación y a su vez se define la función <code class="docutils literal notranslate"><span class="pre">modeloknn()</span></code> para calcular las predicciones y métricas de evaluación como RMSE Y <span class="math notranslate nohighlight">\(R^2\)</span></p>
<div class="alert alert-block" style="background-color: #e1d9e3; color: #30143; padding: 10px; border-radius: 10px;">
    <i class="fa fa-info-circle" aria-hidden="true"></i>
    <strong>Importante:</strong>
    La estímación de los hiperpárametros que  logran que el modelo alcance su mayor desempeño se realizo aplicando la técnica de validación cruzada a tráves de la función <em>GridSearchCV()</em> con un <em>folds = 3</em>.
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">############################Definición de Funciones KNN ############################################################################################################################</span>

<span class="k">def</span> <span class="nf">modeloknn</span><span class="p">(</span><span class="n">df2</span><span class="p">):</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">datos_knn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">datos_knn</span> <span class="o">=</span> <span class="n">datos_knn</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">array</span> <span class="o">=</span> <span class="n">datos_knn</span><span class="o">.</span><span class="n">values</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]))</span>  <span class="c1"># Ajustar índices según las columnas</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># Ajustar índice según la columna de salida</span>
    <span class="n">validation_size</span> <span class="o">=</span> <span class="mf">0.30</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="n">validation_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">steps_knn</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">)]</span>

    <span class="n">pipeline_knn</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps_knn</span><span class="p">)</span>
    <span class="n">x_train_knn</span> <span class="o">=</span> <span class="n">pipeline_knn</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">x_test_knn</span> <span class="o">=</span> <span class="n">pipeline_knn</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># garantizamos que los datos de prueba se escalen usando la misma media y desviación estándar que se calcularon a partir del conjunto de entrenamiento.</span>


    <span class="c1"># Definir parámetros para GridSearchCV</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="s1">&#39;weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]}</span>

    <span class="c1"># Crear el modelo y ajustar GridSearchCV</span>
    <span class="n">bestmodel_knn</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">KNeighborsRegressor</span><span class="p">(),</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">bestmodel_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_knn</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>


    <span class="c1"># Predecir utilizando el modelo ajustado y calcular métricas</span>
    <span class="n">y_train_preds</span> <span class="o">=</span> <span class="n">bestmodel_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train_knn</span><span class="p">)</span>
    <span class="n">y_test_preds</span> <span class="o">=</span> <span class="n">bestmodel_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_knn</span><span class="p">)</span>

    <span class="n">mse_train</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
    <span class="n">rmse_train</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_train</span><span class="p">)</span>

    <span class="n">mse_test</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">rmse_test</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_test</span><span class="p">)</span>

    <span class="c1"># Calcular el R^2</span>
    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

    
    <span class="k">return</span> <span class="n">rmse_test</span><span class="p">,</span> <span class="n">rmse_train</span><span class="p">,</span> <span class="n">y_train_preds</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">,</span> <span class="n">r2_test</span><span class="p">,</span> <span class="n">r2_train</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#llamado de modelo, entrenamiento de modelo y cálculo de métricas.</span>
<span class="n">rmse_test_knn</span><span class="p">,</span> <span class="n">rmse_train_knn</span><span class="p">,</span> <span class="n">y_train_preds_knn</span><span class="p">,</span> <span class="n">y_test_preds_knn</span><span class="p">,</span> <span class="n">r2_test_knn</span><span class="p">,</span> <span class="n">r2_train_knn</span> <span class="o">=</span> <span class="n">modeloknn</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#llamado de modelo, entrenamiento de modelo y cálculo de métricas.</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">rmse_test_knn</span><span class="p">,</span> <span class="n">rmse_train_knn</span><span class="p">,</span> <span class="n">y_train_preds_knn</span><span class="p">,</span> <span class="n">y_test_preds_knn</span><span class="p">,</span> <span class="n">r2_test_knn</span><span class="p">,</span> <span class="n">r2_train_knn</span> <span class="o">=</span> <span class="n">modeloknn</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="nn">Cell In[16], line 32,</span> in <span class="ni">modeloknn</span><span class="nt">(df2)</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> <span class="c1"># Crear el modelo y ajustar GridSearchCV</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span> <span class="n">bestmodel_knn</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">KNeighborsRegressor</span><span class="p">(),</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">32</span> <span class="n">bestmodel_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_knn</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span> <span class="c1"># Predecir utilizando el modelo ajustado y calcular métricas</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span> <span class="n">y_train_preds</span> <span class="o">=</span> <span class="n">bestmodel_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train_knn</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\base.py:1473,</span> in <span class="ni">_fit_context.&lt;locals&gt;.decorator.&lt;locals&gt;.wrapper</span><span class="nt">(estimator, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1466</span>     <span class="n">estimator</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1468</span> <span class="k">with</span> <span class="n">config_context</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1469</span>     <span class="n">skip_parameter_validation</span><span class="o">=</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1470</span>         <span class="n">prefer_skip_nested_validation</span> <span class="ow">or</span> <span class="n">global_skip_validation</span>
<span class="g g-Whitespace">   </span><span class="mi">1471</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1472</span> <span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1473</span>     <span class="k">return</span> <span class="n">fit_method</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\model_selection\_search.py:1018,</span> in <span class="ni">BaseSearchCV.fit</span><span class="nt">(self, X, y, **params)</span>
<span class="g g-Whitespace">   </span><span class="mi">1012</span>     <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_results</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span>         <span class="n">all_candidate_params</span><span class="p">,</span> <span class="n">n_splits</span><span class="p">,</span> <span class="n">all_out</span><span class="p">,</span> <span class="n">all_more_results</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1016</span>     <span class="k">return</span> <span class="n">results</span>
<span class="ne">-&gt; </span><span class="mi">1018</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_search</span><span class="p">(</span><span class="n">evaluate_candidates</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1020</span> <span class="c1"># multimetric is determined here because in the case of a callable</span>
<span class="g g-Whitespace">   </span><span class="mi">1021</span> <span class="c1"># self.scoring the return type is only known after calling</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span> <span class="n">first_test_score</span> <span class="o">=</span> <span class="n">all_out</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;test_scores&quot;</span><span class="p">]</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\model_selection\_search.py:1572,</span> in <span class="ni">GridSearchCV._run_search</span><span class="nt">(self, evaluate_candidates)</span>
<span class="g g-Whitespace">   </span><span class="mi">1570</span> <span class="k">def</span> <span class="nf">_run_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluate_candidates</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1571</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Search all candidates in param_grid&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1572</span>     <span class="n">evaluate_candidates</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">))</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\model_selection\_search.py:964,</span> in <span class="ni">BaseSearchCV.fit.&lt;locals&gt;.evaluate_candidates</span><span class="nt">(candidate_params, cv, more_results)</span>
<span class="g g-Whitespace">    </span><span class="mi">956</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">957</span>     <span class="nb">print</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">958</span>         <span class="s2">&quot;Fitting </span><span class="si">{0}</span><span class="s2"> folds for each of </span><span class="si">{1}</span><span class="s2"> candidates,&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">959</span>         <span class="s2">&quot; totalling </span><span class="si">{2}</span><span class="s2"> fits&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">960</span>             <span class="n">n_splits</span><span class="p">,</span> <span class="n">n_candidates</span><span class="p">,</span> <span class="n">n_candidates</span> <span class="o">*</span> <span class="n">n_splits</span>
<span class="g g-Whitespace">    </span><span class="mi">961</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">962</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">964</span> <span class="n">out</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">965</span>     <span class="n">delayed</span><span class="p">(</span><span class="n">_fit_and_score</span><span class="p">)(</span>
<span class="g g-Whitespace">    </span><span class="mi">966</span>         <span class="n">clone</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">967</span>         <span class="n">X</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">968</span>         <span class="n">y</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">969</span>         <span class="n">train</span><span class="o">=</span><span class="n">train</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">970</span>         <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">971</span>         <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">972</span>         <span class="n">split_progress</span><span class="o">=</span><span class="p">(</span><span class="n">split_idx</span><span class="p">,</span> <span class="n">n_splits</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">973</span>         <span class="n">candidate_progress</span><span class="o">=</span><span class="p">(</span><span class="n">cand_idx</span><span class="p">,</span> <span class="n">n_candidates</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">974</span>         <span class="o">**</span><span class="n">fit_and_score_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">975</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">976</span>     <span class="k">for</span> <span class="p">(</span><span class="n">cand_idx</span><span class="p">,</span> <span class="n">parameters</span><span class="p">),</span> <span class="p">(</span><span class="n">split_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">))</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">977</span>         <span class="nb">enumerate</span><span class="p">(</span><span class="n">candidate_params</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">978</span>         <span class="nb">enumerate</span><span class="p">(</span><span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">routed_params</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">)),</span>
<span class="g g-Whitespace">    </span><span class="mi">979</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">980</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">982</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">983</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">984</span>         <span class="s2">&quot;No fits were performed. &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">985</span>         <span class="s2">&quot;Was the CV iterator empty? &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">986</span>         <span class="s2">&quot;Were there no candidates?&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">987</span>     <span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\utils\parallel.py:74,</span> in <span class="ni">Parallel.__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span> <span class="n">config</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> <span class="n">iterable_with_config</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span>     <span class="p">(</span><span class="n">_with_config</span><span class="p">(</span><span class="n">delayed_func</span><span class="p">,</span> <span class="n">config</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span>     <span class="k">for</span> <span class="n">delayed_func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">iterable</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">74</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">iterable_with_config</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\joblib\parallel.py:1918,</span> in <span class="ni">Parallel.__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1916</span>     <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sequential_output</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1917</span>     <span class="nb">next</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1918</span>     <span class="k">return</span> <span class="n">output</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_generator</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1920</span> <span class="c1"># Let&#39;s create an ID that uniquely identifies the current call. If the</span>
<span class="g g-Whitespace">   </span><span class="mi">1921</span> <span class="c1"># call is interrupted early and that the same instance is immediately</span>
<span class="g g-Whitespace">   </span><span class="mi">1922</span> <span class="c1"># re-used, this id will be used to prevent workers that were</span>
<span class="g g-Whitespace">   </span><span class="mi">1923</span> <span class="c1"># concurrently finalizing a task from the previous call to run the</span>
<span class="g g-Whitespace">   </span><span class="mi">1924</span> <span class="c1"># callback.</span>
<span class="g g-Whitespace">   </span><span class="mi">1925</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\joblib\parallel.py:1847,</span> in <span class="ni">Parallel._get_sequential_output</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1845</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dispatched_batches</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="g g-Whitespace">   </span><span class="mi">1846</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dispatched_tasks</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">-&gt; </span><span class="mi">1847</span> <span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1848</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_completed_tasks</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="g g-Whitespace">   </span><span class="mi">1849</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_progress</span><span class="p">()</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\utils\parallel.py:136,</span> in <span class="ni">_FuncWrapper.__call__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span> <span class="k">with</span> <span class="n">config_context</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">136</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\model_selection\_validation.py:910,</span> in <span class="ni">_fit_and_score</span><span class="nt">(estimator, X, y, scorer, train, test, verbose, parameters, fit_params, score_params, return_train_score, return_parameters, return_n_test_samples, return_times, return_estimator, split_progress, candidate_progress, error_score)</span>
<span class="g g-Whitespace">    </span><span class="mi">907</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;fit_error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">909</span> <span class="n">fit_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="ne">--&gt; </span><span class="mi">910</span> <span class="n">test_scores</span> <span class="o">=</span> <span class="n">_score</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">911</span>     <span class="n">estimator</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scorer</span><span class="p">,</span> <span class="n">score_params_test</span><span class="p">,</span> <span class="n">error_score</span>
<span class="g g-Whitespace">    </span><span class="mi">912</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">913</span> <span class="n">score_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">-</span> <span class="n">fit_time</span>
<span class="g g-Whitespace">    </span><span class="mi">914</span> <span class="k">if</span> <span class="n">return_train_score</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\model_selection\_validation.py:971,</span> in <span class="ni">_score</span><span class="nt">(estimator, X_test, y_test, scorer, score_params, error_score)</span>
<span class="g g-Whitespace">    </span><span class="mi">969</span>         <span class="n">scores</span> <span class="o">=</span> <span class="n">scorer</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="o">**</span><span class="n">score_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">970</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">971</span>         <span class="n">scores</span> <span class="o">=</span> <span class="n">scorer</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="o">**</span><span class="n">score_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">972</span> <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">973</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scorer</span><span class="p">,</span> <span class="n">_MultimetricScorer</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">974</span>         <span class="c1"># If `_MultimetricScorer` raises exception, the `error_score`</span>
<span class="g g-Whitespace">    </span><span class="mi">975</span>         <span class="c1"># parameter is equal to &quot;raise&quot;.</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\metrics\_scorer.py:455,</span> in <span class="ni">_PassthroughScorer.__call__</span><span class="nt">(self, estimator, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">453</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">454</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Method that wraps estimator.score&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">455</span>     <span class="k">return</span> <span class="n">estimator</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\base.py:848,</span> in <span class="ni">RegressorMixin.score</span><span class="nt">(self, X, y, sample_weight)</span>
<span class="g g-Whitespace">    </span><span class="mi">806</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Return the coefficient of determination of the prediction.</span>
<span class="g g-Whitespace">    </span><span class="mi">807</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">808</span><span class="sd"> The coefficient of determination :math:`R^2` is defined as</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">843</span><span class="sd"> :class:`~sklearn.multioutput.MultiOutputRegressor`).</span>
<span class="g g-Whitespace">    </span><span class="mi">844</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">846</span> <span class="kn">from</span> <span class="nn">.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="ne">--&gt; </span><span class="mi">848</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">849</span> <span class="k">return</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\neighbors\_regression.py:242,</span> in <span class="ni">KNeighborsRegressor.predict</span><span class="nt">(self, X)</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Predict the target for the provided data.</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">228</span><span class="sd"> Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">237</span><span class="sd">     Target values.</span>
<span class="g g-Whitespace">    </span><span class="mi">238</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">==</span> <span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span>     <span class="c1"># In that case, we do not need the distances to perform</span>
<span class="g g-Whitespace">    </span><span class="mi">241</span>     <span class="c1"># the weighting so we do not compute them.</span>
<span class="ne">--&gt; </span><span class="mi">242</span>     <span class="n">neigh_ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">return_distance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">243</span>     <span class="n">neigh_dist</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">244</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\neighbors\_base.py:903,</span> in <span class="ni">KNeighborsMixin.kneighbors</span><span class="nt">(self, X, n_neighbors, return_distance)</span>
<span class="g g-Whitespace">    </span><span class="mi">898</span>     <span class="k">if</span> <span class="n">issparse</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">899</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">900</span>             <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> does not work with sparse matrices. Densify the data, &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">901</span>             <span class="s2">&quot;or set algorithm=&#39;brute&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_method</span>
<span class="g g-Whitespace">    </span><span class="mi">902</span>         <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">903</span>     <span class="n">chunked_results</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
<span class="g g-Whitespace">    </span><span class="mi">904</span>         <span class="n">delayed</span><span class="p">(</span><span class="n">_tree_query_parallel_helper</span><span class="p">)(</span>
<span class="g g-Whitespace">    </span><span class="mi">905</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_tree</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">n_neighbors</span><span class="p">,</span> <span class="n">return_distance</span>
<span class="g g-Whitespace">    </span><span class="mi">906</span>         <span class="p">)</span>
<span class="nn">    907         for s</span> in <span class="ni">gen_even_slices</span><span class="nt">(X.shape[0], n_jobs)</span>
<span class="g g-Whitespace">    </span><span class="mi">908</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">909</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">910</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;internal: _fit_method not recognized&quot;</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\utils\parallel.py:74,</span> in <span class="ni">Parallel.__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span> <span class="n">config</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> <span class="n">iterable_with_config</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span>     <span class="p">(</span><span class="n">_with_config</span><span class="p">(</span><span class="n">delayed_func</span><span class="p">,</span> <span class="n">config</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span>     <span class="k">for</span> <span class="n">delayed_func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">iterable</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">74</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">iterable_with_config</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\joblib\parallel.py:1918,</span> in <span class="ni">Parallel.__call__</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1916</span>     <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sequential_output</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1917</span>     <span class="nb">next</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1918</span>     <span class="k">return</span> <span class="n">output</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_generator</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1920</span> <span class="c1"># Let&#39;s create an ID that uniquely identifies the current call. If the</span>
<span class="g g-Whitespace">   </span><span class="mi">1921</span> <span class="c1"># call is interrupted early and that the same instance is immediately</span>
<span class="g g-Whitespace">   </span><span class="mi">1922</span> <span class="c1"># re-used, this id will be used to prevent workers that were</span>
<span class="g g-Whitespace">   </span><span class="mi">1923</span> <span class="c1"># concurrently finalizing a task from the previous call to run the</span>
<span class="g g-Whitespace">   </span><span class="mi">1924</span> <span class="c1"># callback.</span>
<span class="g g-Whitespace">   </span><span class="mi">1925</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\joblib\parallel.py:1847,</span> in <span class="ni">Parallel._get_sequential_output</span><span class="nt">(self, iterable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1845</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dispatched_batches</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="g g-Whitespace">   </span><span class="mi">1846</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dispatched_tasks</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">-&gt; </span><span class="mi">1847</span> <span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1848</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_completed_tasks</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="g g-Whitespace">   </span><span class="mi">1849</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_progress</span><span class="p">()</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\utils\parallel.py:136,</span> in <span class="ni">_FuncWrapper.__call__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span> <span class="k">with</span> <span class="n">config_context</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">136</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\envs\ml\lib\site-packages\sklearn\neighbors\_base.py:704,</span> in <span class="ni">_tree_query_parallel_helper</span><span class="nt">(tree, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">698</span> <span class="k">def</span> <span class="nf">_tree_query_parallel_helper</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">699</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Helper for the Parallel calls in KNeighborsMixin.kneighbors.</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">701</span><span class="sd">     The Cython method tree.query is not directly picklable by cloudpickle</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span><span class="sd">     under PyPy.</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">704</span>     <span class="k">return</span> <span class="n">tree</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;KNN: RMSE en el conjunto de entrenamiento en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_train_knn</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;KNN: RMSE en el conjunto de prueba en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_test_knn</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;KNN: R2 en el conjunto de entrenamiento: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_train_knn</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;KNN: R2 en el conjunto de prueba: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_test_knn</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KNN: RMSE en el conjunto de entrenamiento en 0.0 USD
KNN: RMSE en el conjunto de prueba en 61993.75 USD
KNN: R2 en el conjunto de entrenamiento: 100.0 %
KNN: R2 en el conjunto de prueba: 71.23 %
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo-linear-regression-lr">
<h3>4.2 <font color="#30143">Construcción del modelo Linear Regression (LR)</font><a class="headerlink" href="#construccion-del-modelo-linear-regression-lr" title="Link to this heading">#</a></h3>
<p>Definición de función <code class="docutils literal notranslate"><span class="pre">modelorl()</span></code> para calcular las predicciones y métricas de evaluación como RMSE Y <span class="math notranslate nohighlight">\(R^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>

<span class="c1">############################Definición de Funciones RL ############################################################################################################################</span>

<span class="k">def</span> <span class="nf">modelorl</span><span class="p">(</span><span class="n">df2</span><span class="p">):</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">datos_rl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">datos_rl</span> <span class="o">=</span> <span class="n">datos_rl</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">array</span> <span class="o">=</span> <span class="n">datos_rl</span><span class="o">.</span><span class="n">values</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]))</span>  <span class="c1"># Ajustar índices según las columnas</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># Ajustar índice según la columna de salida</span>
    <span class="n">validation_size</span> <span class="o">=</span> <span class="mf">0.30</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="n">validation_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">steps_rl</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">)]</span>

    <span class="n">pipeline_rl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps_rl</span><span class="p">)</span>
    <span class="n">x_train_rl</span> <span class="o">=</span> <span class="n">pipeline_rl</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">x_test_rl</span> <span class="o">=</span> <span class="n">pipeline_rl</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># garantizamos que los datos de prueba se escalen usando la misma media y desviación estándar que se calcularon a partir del conjunto de entrenamiento.</span>


    <span class="c1"># Crear el modelo y ajustar GridSearchCV</span>
    <span class="n">bestmodel_rl</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">bestmodel_rl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_rl</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>


    <span class="c1"># Predecir utilizando el modelo ajustado y calcular métricas</span>
    <span class="n">y_train_preds</span> <span class="o">=</span> <span class="n">bestmodel_rl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train_rl</span><span class="p">)</span>
    <span class="n">y_test_preds</span> <span class="o">=</span> <span class="n">bestmodel_rl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_rl</span><span class="p">)</span>

    <span class="n">mse_train</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
    <span class="n">rmse_train</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_train</span><span class="p">)</span>

    <span class="n">mse_test</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">rmse_test</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_test</span><span class="p">)</span>

    <span class="c1"># Calcular el R^2</span>
    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rmse_test</span><span class="p">,</span> <span class="n">rmse_train</span><span class="p">,</span> <span class="n">y_train_preds</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">,</span> <span class="n">r2_test</span><span class="p">,</span> <span class="n">r2_train</span><span class="p">,</span> <span class="n">bestmodel_rl</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#llamado de modelo, entrenamiento de modelo y cálculo de métricas.</span>
<span class="n">rmse_test_rl</span><span class="p">,</span> <span class="n">rmse_train_rl</span><span class="p">,</span> <span class="n">y_train_preds_rl</span><span class="p">,</span> <span class="n">y_test_preds_rl</span><span class="p">,</span> <span class="n">r2_test_rl</span><span class="p">,</span> <span class="n">r2_train_rl</span><span class="p">,</span> <span class="n">bestmodel_rl</span> <span class="o">=</span> <span class="n">modelorl</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;LR: RMSE en el conjunto de entrenamiento en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_train_rl</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;LR: RMSE en el conjunto de prueba en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_test_rl</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;LR: R2 en el conjunto de entrenamiento: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_train_rl</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;LR: R2 en el conjunto de prueba: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_test_rl</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LR: RMSE en el conjunto de entrenamiento en 0.0 USD
LR: RMSE en el conjunto de prueba en 70586.2 USD
LR: R2 en el conjunto de entrenamiento: 100.0 %
LR: R2 en el conjunto de prueba: 62.7 %
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo-support-vector-machines-svm">
<h3>4.3 <font color="#30143">Construcción del modelo Support Vector Machines (SVM)</font><a class="headerlink" href="#construccion-del-modelo-support-vector-machines-svm" title="Link to this heading">#</a></h3>
<div class="alert alert-block" style="background-color: #e1d9e3; color: #30143; padding: 10px; border-radius: 10px;">
    <i class="fa fa-info-circle" aria-hidden="true"></i>
    <strong>Importante:</strong>
    La estímación de los hiperpárametros que  logran que el modelo alcance su mayor desempeño se realizo aplicando la técnica de validación cruzada a tráves de la función <em>GridSearchCV()</em> con un <em>folds = 2</em>.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">datos_svr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">datos_svr</span><span class="o">=</span> <span class="n">datos_svr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">datos_svr</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]))</span>  <span class="c1"># Ajustar índices según las columnas</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># Ajustar índice según la columna de salida</span>


<span class="c1"># Crear un pipeline que aplica SVR</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">SVR</span><span class="p">())</span>

<span class="c1"># Definir el rango de hiperparámetros para el Grid Search</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;svr__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">],</span>
    <span class="s1">&#39;svr__gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">]}</span>


<span class="c1"># Configurar el Grid Search con validación cruzada</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Ejecutar el Grid Search</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="c1"># Imprimir los mejores parámetros encontrados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros encontrados:&quot;</span><span class="p">,</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 2 folds for each of 8 candidates, totalling 16 fits
Mejores parámetros encontrados: {&#39;svr__C&#39;: 1000000, &#39;svr__gamma&#39;: &#39;scale&#39;}
</pre></div>
</div>
</div>
</div>
<p>Definición de función <code class="docutils literal notranslate"><span class="pre">modeloSVR()</span></code> para calcular las predicciones y métricas de evaluación como RMSE Y <span class="math notranslate nohighlight">\(R^2\)</span>. de acuerdo a los resultados anteriores para cada uno de los <code class="docutils literal notranslate"><span class="pre">kernel</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1">############################Definición de Funciones SVR ############################################################################################################################</span>

<span class="k">def</span> <span class="nf">modeloSVR</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span><span class="n">kernel_input</span><span class="p">):</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">datos_svr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">datos_svr</span><span class="o">=</span> <span class="n">datos_svr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">array</span> <span class="o">=</span> <span class="n">datos_svr</span><span class="o">.</span><span class="n">values</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]))</span>  <span class="c1"># Ajustar índices según las columnas</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># Ajustar índice según la columna de salida</span>
    <span class="n">validation_size</span> <span class="o">=</span> <span class="mf">0.30</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="n">validation_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">steps_svr</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">)]</span>

    <span class="n">pipeline_svr</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps_svr</span><span class="p">)</span>
    <span class="n">x_train_svr</span> <span class="o">=</span> <span class="n">pipeline_svr</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">x_test_svr</span> <span class="o">=</span> <span class="n">pipeline_svr</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># garantizamos que los datos de prueba se escalen usando la misma media y desviación estándar que se calcularon a partir del conjunto de entrenamiento.</span>


    <span class="c1"># Crear el modelo Suppor Vector Machine Regresion</span>
    <span class="n">bestmodel_svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span> <span class="n">kernel_input</span> <span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1000000</span><span class="p">)</span>
    <span class="n">bestmodel_svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_svr</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>


    <span class="c1"># Predecir utilizando el modelo ajustado y calcular métricas</span>
    <span class="n">y_train_preds</span> <span class="o">=</span> <span class="n">bestmodel_svr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train_svr</span><span class="p">)</span>
    <span class="n">y_test_preds</span> <span class="o">=</span> <span class="n">bestmodel_svr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_svr</span><span class="p">)</span>

    <span class="n">mse_train</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
    <span class="n">rmse_train</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_train</span><span class="p">)</span>

    <span class="n">mse_test</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">rmse_test</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_test</span><span class="p">)</span>

    <span class="c1"># Calcular el R^2</span>
    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rmse_test</span><span class="p">,</span> <span class="n">rmse_train</span><span class="p">,</span> <span class="n">y_train_preds</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">,</span> <span class="n">r2_test</span><span class="p">,</span> <span class="n">r2_train</span><span class="p">,</span> <span class="n">bestmodel_svr</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo-svm-usando-kernel-linear">
<h3>4.3.1 <font color="#30143">Construcción del modelo SVM usando Kernel Linear</font><a class="headerlink" href="#construccion-del-modelo-svm-usando-kernel-linear" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#llamado de modelo, entrenamiento de modelo y cálculo de métricas.</span>
<span class="n">rmse_test_svr_l</span><span class="p">,</span> <span class="n">rmse_train_svr_l</span><span class="p">,</span> <span class="n">y_train_preds_svr_l</span><span class="p">,</span> <span class="n">y_test_preds_svr_l</span><span class="p">,</span> <span class="n">r2_test_svr_l</span><span class="p">,</span> <span class="n">r2_train_svr_l</span><span class="p">,</span> <span class="n">bestmodel_svr_l</span> <span class="o">=</span> <span class="n">modeloSVR</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: RMSE en el conjunto de entrenamiento en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_train_svr_l</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: RMSE en el conjunto de prueba en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_test_svr_l</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: R2 en el conjunto de entrenamiento: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_train_svr_l</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: R2 en el conjunto de prueba: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_test_svr_l</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVM: RMSE en el conjunto de entrenamiento en 0.0 USD
SVM: RMSE en el conjunto de prueba en 72280.49 USD
SVM: R2 en el conjunto de entrenamiento: 100.0 %
SVM: R2 en el conjunto de prueba: 60.89 %
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo-svm-usando-kernel-polinomial">
<h3>4.3.2 <font color="#30143">Construcción del modelo SVM usando Kernel Polinomial</font><a class="headerlink" href="#construccion-del-modelo-svm-usando-kernel-polinomial" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#llamado de modelo, entrenamiento de modelo y cálculo de métricas.</span>
<span class="n">rmse_test_svr_p</span><span class="p">,</span> <span class="n">rmse_train_svr_p</span><span class="p">,</span> <span class="n">y_train_preds_svr_p</span><span class="p">,</span> <span class="n">y_test_preds_svr_p</span><span class="p">,</span> <span class="n">r2_test_svr_p</span><span class="p">,</span> <span class="n">r2_train_svr_p</span><span class="p">,</span> <span class="n">bestmodel_svr_P</span> <span class="o">=</span> <span class="n">modeloSVR</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span><span class="s1">&#39;poly&#39;</span><span class="p">)</span> <span class="c1">#Grado polinomial por defecto, grado 3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: RMSE en el conjunto de entrenamiento en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_train_svr_p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: RMSE en el conjunto de prueba en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_test_svr_p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: R2 en el conjunto de entrenamiento: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_train_svr_p</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: R2 en el conjunto de prueba: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_test_svr_p</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVM: RMSE en el conjunto de entrenamiento en 0.0 USD
SVM: RMSE en el conjunto de prueba en 85082.99 USD
SVM: R2 en el conjunto de entrenamiento: 100.0 %
SVM: R2 en el conjunto de prueba: 45.81 %
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo-svm-usando-kernel-rbf-radial-basis-function">
<h3>4.3.3 <font color="#30143">Construcción del modelo SVM usando Kernel RBF (Radial Basis Function)</font><a class="headerlink" href="#construccion-del-modelo-svm-usando-kernel-rbf-radial-basis-function" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#llamado de modelo, entrenamiento de modelo y cálculo de métricas.</span>
<span class="n">rmse_test_svr_rbf</span><span class="p">,</span> <span class="n">rmse_train_svr_rbf</span><span class="p">,</span> <span class="n">y_train_preds_svr_rbf</span><span class="p">,</span> <span class="n">y_test_preds_svr_rbf</span><span class="p">,</span> <span class="n">r2_test_svr_rbf</span><span class="p">,</span> <span class="n">r2_train_svr_rbf</span><span class="p">,</span> <span class="n">bestmodel_svr_rbf</span> <span class="o">=</span> <span class="n">modeloSVR</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: RMSE en el conjunto de entrenamiento en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_train_svr_rbf</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: RMSE en el conjunto de prueba en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_test_svr_rbf</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: R2 en el conjunto de entrenamiento: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_train_svr_rbf</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SVM: R2 en el conjunto de prueba: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_test_svr_rbf</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVM: RMSE en el conjunto de entrenamiento en 0.0 USD
SVM: RMSE en el conjunto de prueba en 58641.05 USD
SVM: R2 en el conjunto de entrenamiento: 100.0 %
SVM: R2 en el conjunto de prueba: 74.26 %
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo-lasso">
<h3>4.4 <font color="#30143">Construcción del modelo Lasso</font><a class="headerlink" href="#construccion-del-modelo-lasso" title="Link to this heading">#</a></h3>
<div class="alert alert-block" style="background-color: #e1d9e3; color: #30143; padding: 10px; border-radius: 10px;">
    <i class="fa fa-info-circle" aria-hidden="true"></i>
    <strong>Importante:</strong>
    La estímación de los hiperpárametros que  logran que el modelo alcance su mayor desempeño se realizo aplicando la técnica de validación cruzada a tráves de la función <em>GridSearchCV()</em> con un <em>folds = 5</em>.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">datos_svr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">datos_svr</span><span class="o">=</span> <span class="n">datos_svr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">datos_svr</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]))</span>  <span class="c1"># Ajustar índices según las columnas</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># Ajustar índice según la columna de salida</span>


<span class="c1"># Crear un pipeline que estandariza los datos y aplica Lasso</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">Lasso</span><span class="p">())</span>

<span class="c1"># Definir el rango de valores para el parámetro alpha</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;lasso__alpha&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># Valores de alpha desde 0.0001 hasta 1</span>
<span class="p">}</span>

<span class="c1"># Configurar el Grid Search con validación cruzada</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Ejecutar el Grid Search</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="c1"># Imprimir los mejores parámetros encontrados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor valor de alpha:&quot;</span><span class="p">,</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;lasso__alpha&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 5 candidates, totalling 25 fits
Mejor valor de alpha: 1.0
</pre></div>
</div>
</div>
</div>
<p>Definición de función <code class="docutils literal notranslate"><span class="pre">modelolasso()</span></code> para calcular las predicciones y métricas de evaluación como RMSE Y <span class="math notranslate nohighlight">\(R^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>

<span class="k">def</span> <span class="nf">modelolasso</span><span class="p">(</span><span class="n">df2</span><span class="p">):</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">datos_lasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">datos_lasso</span> <span class="o">=</span> <span class="n">datos_lasso</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">array</span> <span class="o">=</span> <span class="n">datos_lasso</span><span class="o">.</span><span class="n">values</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]))</span>  <span class="c1"># Ajustar índices según las columnas</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># Ajustar índice según la columna de salida</span>
    <span class="n">validation_size</span> <span class="o">=</span> <span class="mf">0.30</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="n">validation_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">steps_lasso</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">)]</span>

    <span class="n">pipeline_lasso</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps_lasso</span><span class="p">)</span>
    <span class="n">x_train_lasso</span> <span class="o">=</span> <span class="n">pipeline_lasso</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">x_test_lasso</span> <span class="o">=</span> <span class="n">pipeline_lasso</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># garantizamos que los datos de prueba se escalen usando la misma media y desviación estándar que se calcularon a partir del conjunto de entrenamiento.</span>


    <span class="c1"># Crear el modelo Lasso</span>
    <span class="n">bestmodel_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">bestmodel_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_lasso</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>


    <span class="c1"># Predecir utilizando el modelo ajustado y calcular métricas</span>
    <span class="n">y_train_preds</span> <span class="o">=</span> <span class="n">bestmodel_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train_lasso</span><span class="p">)</span>
    <span class="n">y_test_preds</span> <span class="o">=</span> <span class="n">bestmodel_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_lasso</span><span class="p">)</span>

    <span class="n">mse_train</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
    <span class="n">rmse_train</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_train</span><span class="p">)</span>

    <span class="n">mse_test</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">rmse_test</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_test</span><span class="p">)</span>

    <span class="c1"># Calcular el R^2</span>
    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rmse_test</span><span class="p">,</span> <span class="n">rmse_train</span><span class="p">,</span> <span class="n">y_train_preds</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">,</span> <span class="n">r2_test</span><span class="p">,</span> <span class="n">r2_train</span><span class="p">,</span> <span class="n">bestmodel_lasso</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#llamado de modelo, entrenamiento de modelo y cálculo de métricas.</span>
<span class="n">rmse_test_lasso</span><span class="p">,</span> <span class="n">rmse_train_lasso</span><span class="p">,</span> <span class="n">y_train_preds_lasso</span><span class="p">,</span> <span class="n">y_test_preds_lasso</span><span class="p">,</span> <span class="n">r2_test_lasso</span><span class="p">,</span> <span class="n">r2_train_lasso</span><span class="p">,</span> <span class="n">bestmodel_lasso</span> <span class="o">=</span> <span class="n">modelolasso</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lasso: RMSE en el conjunto de entrenamiento en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_train_lasso</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lasso: RMSE en el conjunto de prueba en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_test_lasso</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lasso: R2 en el conjunto de entrenamiento: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_train_lasso</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lasso: R2 en el conjunto de prueba: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_test_lasso</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lasso: RMSE en el conjunto de entrenamiento en 0.0 USD
Lasso: RMSE en el conjunto de prueba en 70586.15 USD
Lasso: R2 en el conjunto de entrenamiento: 100.0 %
Lasso: R2 en el conjunto de prueba: 62.7 %
</pre></div>
</div>
</div>
</div>
</section>
<section id="construccion-del-modelo-ridge">
<h3>4.5 <font color="#30143">Construcción del modelo Ridge</font><a class="headerlink" href="#construccion-del-modelo-ridge" title="Link to this heading">#</a></h3>
<div class="alert alert-block" style="background-color: #e1d9e3; color: #30143; padding: 10px; border-radius: 10px;">
    <i class="fa fa-info-circle" aria-hidden="true"></i>
    <strong>Importante:</strong>
    La estímación de los hiperpárametros que  logran que el modelo alcance su mayor desempeño se realizo aplicando la técnica de validación cruzada a tráves de la función <em>GridSearchCV()</em> con un <em>folds = 5</em>.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">,</span> <span class="n">Lasso</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">datos_ridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">datos_ridge</span><span class="o">=</span> <span class="n">datos_ridge</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">datos_ridge</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]))</span>  <span class="c1"># Ajustar índices según las columnas</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># Ajustar índice según la columna de salida</span>


<span class="c1"># Crear un pipeline que estandariza los datos y aplica Ridge</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">Ridge</span><span class="p">())</span>

<span class="c1"># Definir el rango de valores para el parámetro alpha</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ridge__alpha&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># Valores de alpha desde 0.0001 hasta 1</span>
<span class="p">}</span>

<span class="c1"># Configurar el Grid Search con validación cruzada</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Ejecutar el Grid Search</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="c1"># Imprimir los mejores parámetros encontrados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor valor de alpha:&quot;</span><span class="p">,</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;ridge__alpha&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 5 candidates, totalling 25 fits
Mejor valor de alpha: 1.0
</pre></div>
</div>
</div>
</div>
<p>Definición de función <code class="docutils literal notranslate"><span class="pre">modeloridge()</span></code> para calcular las predicciones y métricas de evaluación como RMSE Y <span class="math notranslate nohighlight">\(R^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>

<span class="k">def</span> <span class="nf">modeloridge</span><span class="p">(</span><span class="n">df2</span><span class="p">):</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">datos_ridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">datos_ridge</span> <span class="o">=</span> <span class="n">datos_ridge</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">array</span> <span class="o">=</span> <span class="n">datos_ridge</span><span class="o">.</span><span class="n">values</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]))</span>  <span class="c1"># Ajustar índices según las columnas</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># Ajustar índice según la columna de salida</span>
    <span class="n">validation_size</span> <span class="o">=</span> <span class="mf">0.30</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="n">validation_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">steps_ridge</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">)]</span>

    <span class="n">pipeline_ridge</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps_ridge</span><span class="p">)</span>
    <span class="n">x_train_ridge</span> <span class="o">=</span> <span class="n">pipeline_ridge</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">x_test_ridge</span> <span class="o">=</span> <span class="n">pipeline_ridge</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># garantizamos que los datos de prueba se escalen usando la misma media y desviación estándar que se calcularon a partir del conjunto de entrenamiento.</span>


    <span class="c1"># Crear el modelo Lasso</span>
    <span class="n">bestmodel_ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">bestmodel_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train_ridge</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>


    <span class="c1"># Predecir utilizando el modelo ajustado y calcular métricas</span>
    <span class="n">y_train_preds</span> <span class="o">=</span> <span class="n">bestmodel_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train_ridge</span><span class="p">)</span>
    <span class="n">y_test_preds</span> <span class="o">=</span> <span class="n">bestmodel_ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_ridge</span><span class="p">)</span>

    <span class="n">mse_train</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
    <span class="n">rmse_train</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_train</span><span class="p">)</span>

    <span class="n">mse_test</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">rmse_test</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse_test</span><span class="p">)</span>

    <span class="c1"># Calcular el R^2</span>
    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">)</span>
    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rmse_test</span><span class="p">,</span> <span class="n">rmse_train</span><span class="p">,</span> <span class="n">y_train_preds</span><span class="p">,</span> <span class="n">y_test_preds</span><span class="p">,</span> <span class="n">r2_test</span><span class="p">,</span> <span class="n">r2_train</span><span class="p">,</span> <span class="n">bestmodel_ridge</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#llamado de modelo, entrenamiento de modelo y cálculo de métricas.</span>
<span class="n">rmse_test_ridge</span><span class="p">,</span> <span class="n">rmse_train_ridge</span><span class="p">,</span> <span class="n">y_train_preds_ridge</span><span class="p">,</span> <span class="n">y_test_preds_ridge</span><span class="p">,</span> <span class="n">r2_test_ridge</span><span class="p">,</span> <span class="n">r2_train_ridge</span><span class="p">,</span> <span class="n">bestmodel_ridge</span> <span class="o">=</span> <span class="n">modeloridge</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lasso: RMSE en el conjunto de entrenamiento en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_train_ridge</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lasso: RMSE en el conjunto de prueba en </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">rmse_test_ridge</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lasso: R2 en el conjunto de entrenamiento: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_train_ridge</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lasso: R2 en el conjunto de prueba: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2_test_ridge</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lasso: RMSE en el conjunto de entrenamiento en 0.0 USD
Lasso: RMSE en el conjunto de prueba en 70586.16 USD
Lasso: R2 en el conjunto de entrenamiento: 100.0 %
Lasso: R2 en el conjunto de prueba: 62.7 %
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="comparacion-de-rendimiento-de-modelos">
<h2>5. <font color="#30143">Comparación de rendimiento de modelos</font><a class="headerlink" href="#comparacion-de-rendimiento-de-modelos" title="Link to this heading">#</a></h2>
<p>A continuación realizamos la estandarización y división de los datos, de igual forma se define el <code class="docutils literal notranslate"><span class="pre">scoring</span></code> como métrica para la evaluación del rendimiento de cada uno de los modelos aplicados en este informe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">datos_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ocean_proximity&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">datos_plot</span> <span class="o">=</span> <span class="n">datos_plot</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">datos_plot</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;median_house_value&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>  <span class="c1"># Características</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">datos_plot</span><span class="p">[</span><span class="s1">&#39;median_house_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>  <span class="c1"># Target</span>

<span class="n">validation_size</span> <span class="o">=</span> <span class="mf">0.30</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;neg_mean_squared_error&#39;</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="n">validation_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">steps_plot</span><span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">)]</span>

<span class="n">pipeline_plot</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps_plot</span><span class="p">)</span>
<span class="n">x_train_plot</span> <span class="o">=</span> <span class="n">pipeline_plot</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">x_test_plot</span> <span class="o">=</span> <span class="n">pipeline_plot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># garantizamos que los datos de prueba se escalen usando la misma media y desviación estándar que se calcularon a partir del conjunto de entrenamiento.</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block" style="background-color: #e1d9e3; color: #30143; padding: 10px; border-radius: 10px;">
    <i class="fa fa-info-circle" aria-hidden="true"></i>
    <strong>Importante:</strong>
    A continuación definimos los modelos con cada uno de los <em>hiperparámetros</em> estimados en cada una de las subsecciones del númeral 4 de este documento, para alcanzar su <em>mejor rendimiento</em>.  
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definir parámetros para KNN</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;weights&#39;</span><span class="p">:</span> <span class="s1">&#39;distance&#39;</span><span class="p">}</span>
<span class="n">model_knn_plot</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="o">**</span><span class="n">parameters</span><span class="p">)</span>

<span class="c1">#Definir parámetros para RL</span>
<span class="n">modelo_rl_plot</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>

<span class="c1">#Definir parámetros para SVR linear</span>
<span class="n">modelo_svml_plot</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1000000</span><span class="p">)</span>

<span class="c1">#Definir parámetros para SVR poly</span>
<span class="n">modelo_svmp_plot</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1000000</span><span class="p">)</span>

<span class="c1">#Definir parámetros para SVR RBF</span>
<span class="n">modelo_svmrbf_plot</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1000000</span><span class="p">)</span>

<span class="c1">#Definir parámetros para Lasso</span>
<span class="n">modelo_lasso_plot</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#Definir parámetros para Ridge</span>
<span class="n">modelo_ridge_plot</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Spot Check Algorithms</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;k-NN&#39;</span><span class="p">,</span> <span class="n">model_knn_plot</span><span class="p">))</span>
<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;RL&#39;</span><span class="p">,</span> <span class="n">modelo_rl_plot</span><span class="p">))</span>
<span class="c1">#models.append((&#39;SVM-Linear&#39;, modelo_svml_plot))</span>
<span class="c1">#models.append((&#39;SVM-Poly&#39;, modelo_svmp_plot))</span>
<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;SVM-RBF&#39;</span><span class="p">,</span> <span class="n">modelo_svmrbf_plot</span><span class="p">))</span>
<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;LASSO&#39;</span><span class="p">,</span> <span class="n">modelo_lasso_plot</span><span class="p">))</span>
<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;RIDGE&#39;</span><span class="p">,</span> <span class="n">modelo_ridge_plot</span><span class="p">))</span>

<span class="n">models</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;k-NN&#39;, KNeighborsRegressor(n_neighbors=11, weights=&#39;distance&#39;)),
 (&#39;RL&#39;, LinearRegression()),
 (&#39;SVM-RBF&#39;, SVR(C=1000000)),
 (&#39;LASSO&#39;, Lasso(alpha=1)),
 (&#39;RIDGE&#39;, Ridge(alpha=1))]
</pre></div>
</div>
</div>
</div>
<p>Comparemos los modelos, calculando la media y la desviación estándar de MSE para cada uno de éstos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">kfold</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#ok</span>
    <span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x_train_plot</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#n_jobs = -1 es oara que el codigo se ejecute mas rapido</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv_results</span><span class="p">)</span>
    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">cv_results</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">,.3f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">cv_results</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">,.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k-NN: -3,789,568,030.506 (176,265,610.889)
RL: -5,064,941,424.330 (277,181,563.642)
SVM-RBF: -3,350,549,011.353 (190,971,904.490)
LASSO: -5,064,933,681.577 (277,173,868.446)
RIDGE: -5,064,893,969.644 (277,156,843.175)
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block" style="background-color: #e1d9e3; color: #30143; padding: 10px; border-radius: 10px;">
    <i class="fa fa-info-circle" aria-hidden="true"></i>
    <strong>Importante:</strong>
    La estímación de estimación de la media y desviación estándar del error cuadrático medio se realiza a tráves de la función <em>cross_val_score()</em> con un <em>folds = 10</em>, usando como medida de desempeño la métrica <em>neg_mean_squared_error</em>. <br><br>
    Dado que nuestro conjunto de datos cuenta con un número considerable de instancias y además, no se cuenta con un equipo de computo con las carácteristicas necesarias para procesar realizar las estimaciónes antes mencionadas, solo se visualizará a trávez del gráfico de comparación de algoritmos el resultado obtenido para el modelo de kNN, Regresión Lineal, Lasso, Ridge y SVM RBF. 
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare Algorithms</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Algorithm Comparison&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4a0dd11c2cd131cedd43a023b56aae3490a3f873c6f519a6831cb8d413175f46.png" src="_images/4a0dd11c2cd131cedd43a023b56aae3490a3f873c6f519a6831cb8d413175f46.png" />
</div>
</div>
<div class="alert alert-block" style="background-color: #e1d9e3; color: #30143; padding: 10px; border-radius: 10px;">
    <i class="fa fa-info-circle" aria-hidden="true"></i>
    <strong>Importante:</strong>
El que más aproximación tiene a cero, es el mejor. De igual forma observamos la distribución de las métricas calculados en los _folds_ de validación cruzada usando <em>Boxplot</em>.  
</div></section>
<hr class="docutils" />
<section id="conclusiones">
<h2>6. <font color="#30143">Conclusiones</font><a class="headerlink" href="#conclusiones" title="Link to this heading">#</a></h2>
<p>Con base en los resultados obtenidos, se concluye que el modelo más efectivo para predecir el precio de una vivienda en California es el <strong>SVM usando Kernel RBF (Radial Basis Function)</strong>, alcanzando un coeficiente de determinación <span class="math notranslate nohighlight">\(R^2 = 74.26\%\)</span>. Este modelo demuestra una capacidad superior para capturar la complejidad de los datos en comparación con otros enfoques evaluados. En segundo lugar, el modelo <strong>K-Nearest Neighbors (KNN)</strong> logró un <span class="math notranslate nohighlight">\(R^2 = 71.23\%\)</span>, mostrando también un rendimiento competitivo. Los modelos de regresión lineal presentaron un rendimiento inferior, con un <span class="math notranslate nohighlight">\(R^2 &lt; 63\%\)</span>. Finalmente, el modelo con el desempeño más bajo fue el <strong>SVM usando Kernel Polinomial</strong>, que obtuvo un <span class="math notranslate nohighlight">\(R^2 = 45.81\%\)</span>, indicando una menor capacidad para ajustar los datos de manera precisa.</p>
<p>Cabe aclarar que los resultados anteriores se obtuvieron estimando los hiperpárametros para cada uno de los modelos usando <code class="docutils literal notranslate"><span class="pre">GridSearchCV()</span></code> con <code class="docutils literal notranslate"><span class="pre">folds</span></code>entre 2 y 5, en vez de 10, lo anterior, debido a que los equipos de computo que se usaron para procesar los algoritmos no contaban con la <code class="docutils literal notranslate"><span class="pre">GPU</span></code> necesaria para el óptimo procesamiento de éstos. Lo anterior, es valido teniendo en cuenta que este análisis se realizo para fines académicos.</p>
<p>A continuación se hace una breve referencia del porque no se usaron otros modelos vistos en el curso de Machine Learing.</p>
<ul class="simple">
<li><p>Arbol de decisión:  Mejor para problemas de clasificación.</p></li>
<li><p>KNN Classifier: Mejor para problemas de clasficiación.</p></li>
<li><p>Redes neuronales convolucionales: Se utiliza para procesar y clasificar imágenes.</p></li>
<li><p>Redes neuronales recurrentes: Ideales para series de tiempo.</p></li>
<li><p>Perceptrón - ADELINE: Podr´ıa no capturar las relaciones no lineales entre las variables conduciendo a subajuste.</p></li>
<li><p>Multilayer Perceptron: El costo computacional es alto; además, la data en análisis podría no ser lo suficientemente grande para este tipo de modelos.</p></li>
<li><p>Naive Bayes: Util en problemas de clasificación, su especialidad son los datos categóricos.</p></li>
</ul>
<hr class="docutils" />
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Introducción análsis predictivo de dataset “California Housing Prices.csv” usando modelos de aprendizaje supervisado (Supervised Learning)</strong></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">1. <font color="#30143">Introducción</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importar-liberias">1.1 <font color="#30143">Importar Liberías</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cargar-el-dataset">1.2 <font color="#30143">Cargar el dataset</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-descriptivo">2. <font color="#30143">Análisis Descriptivo</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimension-del-conjunto-de-datos">2.1 <font color="#30143">Dimensión del Conjunto de datos</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#representacion-del-conjunto-de-datos">2.2 <font color="#30143">Representación del Conjunto de datos</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-estadistico">2.3 <font color="#30143">Resumen Estadístico</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tipo-de-dato">2.4 <font color="#30143">Tipo de dato</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-de-atributos">2.4 <font color="#30143">Correlación de Atributos</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#valores-nan">2.5 <font color="#30143">Valores NaN</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-del-conjunto-de-datos">3. <font color="#30143">Visualización del Conjunto de datos</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma-y-grafico-de-densidad">3.1 <font color="#30143"> Histograma y gráfico de densidad</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagrama-de-cajas-y-bigotes">3.2 <font color="#30143"> Diagrama de Cajas y Bigotes</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagramas-de-dispersion">3.3 <font color="#30143"> Diagramas de dispersión</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion">3.4 <font color="#30143"> Matriz de Correlación</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-de-modelos">4. <font color="#30143">Construcción de Modelos</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-k-nearest-neighbors-knn">4.1 <font color="#30143">Construcción del modelo K-Nearest Neighbors (KNN)</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-linear-regression-lr">4.2 <font color="#30143">Construcción del modelo Linear Regression (LR)</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-support-vector-machines-svm">4.3 <font color="#30143">Construcción del modelo Support Vector Machines (SVM)</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-svm-usando-kernel-linear">4.3.1 <font color="#30143">Construcción del modelo SVM usando Kernel Linear</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-svm-usando-kernel-polinomial">4.3.2 <font color="#30143">Construcción del modelo SVM usando Kernel Polinomial</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-svm-usando-kernel-rbf-radial-basis-function">4.3.3 <font color="#30143">Construcción del modelo SVM usando Kernel RBF (Radial Basis Function)</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-lasso">4.4 <font color="#30143">Construcción del modelo Lasso</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construccion-del-modelo-ridge">4.5 <font color="#30143">Construcción del modelo Ridge</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-de-rendimiento-de-modelos">5. <font color="#30143">Comparación de rendimiento de modelos</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">6. <font color="#30143">Conclusiones</font></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Díaz Gabriela, Gómez Elianna, Tajan Katherine
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>